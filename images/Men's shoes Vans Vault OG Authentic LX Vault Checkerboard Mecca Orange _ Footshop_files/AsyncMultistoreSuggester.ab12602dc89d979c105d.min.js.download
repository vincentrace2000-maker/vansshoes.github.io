(window.webpackJsonp=window.webpackJsonp||[]).push([["AsyncMultistoreSuggester"],{"3EdS":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s}));n("UxlC"),n("3bBZ"),n("Kz25");var a=n("UIBx");const r={CONFIRM:"language_switcher_confirm",CLOSE:"language_switcher_close",CHANGE:"language_change"};function c({event:e,suggested:t,selected:n}){const c=e===r.CONFIRM?{switcher:{suggested:t,selected:n}}:{};Object(a.a)({event:e,...c,_clear:!0})}function s({language:e,currency:t,url:n}){const c=new URL(n);Object(a.a)({event:r.CHANGE,language:e.toLowerCase(),currency:t,site:c.hostname.replace("www.",""),_clear:!0})}},"3fsA":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n("UYTu");const r=a.d`
    fragment DeliveryCountryFields on DeliveryCountry {
        id
        name
        image
        hasShop
        suggested
        currency
        languages {
            id
            name
            url
            site
        }
    }
`,c=a.d`
    query getDeliveryCountries($language: String) {
        deliveryCountries(language: $language) {
            ...DeliveryCountryFields
        }
    }
    ${r}
`,s=a.d`
    query shopRedirect($country: String!, $language: String!) {
        shopRedirect(country: $country, language: $language) {
            url
        }
    }
`,o=a.d`
    query detectShop {
        detectShop {
            message
            suggestedShopId
            acceptButtonText
            closeButtonText
            suggestedDeliveryCountry {
                ...DeliveryCountryFields
            }
        }
    }
    ${r}
`},EnoZ:function(e,t,n){"use strict";n.r(t);n("3bBZ");var a=n("q1tI"),r=n.n(a),c=n("aoTL"),s=n("Lm/n"),o=n("3fsA"),u=n("Ehug"),l=n("bsWm");var i=n("4msA"),d=n("SYWT");function g(e){i.d.set("ftshpShopByGeoIp",e,120)}function p(e,t){return 0===e||e===t}var m=n("3EdS"),f="MultistoreSuggester_suggester_1-ydg",h="MultistoreSuggester_dropdown_q8wF8",S="MultistoreSuggester_dropdownItem_10d31",b="MultistoreSuggester_close_2cjaN";const y=Object(c.b)(({data:e,onClose:t})=>{const{deviceStore:{isMobile:n},generalStore:{currentShop:c},translationStore:i}=Object(u.X)(),{suggestedShopId:p,suggestedDeliveryCountry:y,acceptButtonText:v,message:C}=e,[E,{loading:O,error:w}]=Object(s.a)(o.c,{onCompleted:({shopRedirect:e})=>{(null==e?void 0:e.url)&&window.location.assign(e.url)}}),[j,I]=Object(a.useState)(y.languages[0]),_=Object(a.useCallback)(e=>{I(e)},[]),N=Object(a.useCallback)(()=>{E({variables:{country:y.id,language:j.id}}),g(p),Object(m.c)({event:m.a.CONFIRM,suggested:y.languages.map(e=>e.id),selected:j.id})},[E,y,j,p]),B=Object(a.useCallback)(()=>{g(c.id),Object(m.c)({event:m.a.CLOSE}),t()},[c,t]);return Object(a.useEffect)(()=>{w&&d.a.warn("Failed to submit shopRedirect from Multistore suggester")},[w]),r.a.createElement(r.a.Fragment,null,w&&r.a.createElement(l.s,null,i.getTranslation("common.errors.somethingBroken")),r.a.createElement("div",{className:f},r.a.createElement("p",null,C),r.a.createElement(l.p,{className:h,items:y.languages,activeItem:j,activeItemTemplate:e=>r.a.createElement("div",{className:S},e.name),itemTemplate:e=>r.a.createElement("div",{className:S},e.name),fullWidth:n,outlined:!0,onSelect:_}),r.a.createElement(l.h,{align:n?"column-full-width":"row-left"},r.a.createElement(l.T,{leftIcon:O&&r.a.createElement(l.ob,null),disabled:O,onClick:N},v)),r.a.createElement("div",{className:b},r.a.createElement(l.gb,{onClick:B},r.a.createElement(l.pb,{id:"close"})))))}),v=Object(c.b)(()=>{const{generalStore:{currentShop:e}}=Object(u.X)(),[t,n]=Object(a.useState)(null),[c,{data:l,error:g}]=Object(s.a)(o.b),m=e.id;return Object(a.useEffect)(()=>{if(e=m,i.d.get("ftshpShopByGeoIp")===String(e))return;var e;const t=function(){const e=i.d.get("ftshpDetectedShopByGeoIp");if(!e)return null;try{return JSON.parse(e)}catch(e){return d.a.warn("Failed to parse and save ftshpDetectedShopByGeoIp cookie"),null}}();p(null==t?void 0:t.suggestedShopId,m)||n(t),t||c()},[c,m]),Object(a.useEffect)(()=>{null!=l&&l.detectShop&&(p(l.detectShop.suggestedShopId,m)||(n(l.detectShop),function(e){i.d.set("ftshpDetectedShopByGeoIp",JSON.stringify(e))}(l.detectShop)))},[l,m]),Object(a.useEffect)(()=>{g&&d.a.warn("Failed detect shop query.")},[g]),null!=t&&t.suggestedDeliveryCountry?r.a.createElement(y,{data:t,onClose:()=>n(null)}):null});t.default=v}}]);
//# sourceMappingURL=AsyncMultistoreSuggester.ab12602dc89d979c105d.min.js.map